<!DOCTYPE html><html lang="en" dir="ltr"><head><title>Poisson Gravity</title><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="../css/github-markdown.css"><link rel="stylesheet" type="text/css" href="../css/katex.min.css"><link rel="stylesheet" type="text/css" href="../css/codemirror.css"><link rel="stylesheet" type="text/css" href="../css/styles.css">
<script type="text/javascript">window.demoScripts = undefined;</script>
<script type="text/javascript" src="../js/demo-loader-bundle.min.js"></script><meta name="application-name" content="Poisson Gravity">
<meta name="subject" content="Poisson Gravity">
<meta name="abstract" content="Poisson Gravity">
<meta name="twitter:title" content="Poisson Gravity">
<meta name="author" content="Ricky Reusser">
<meta name="twitter:creator" content="Ricky Reusser">
<meta itemprop="title" content="Poisson Gravity">
<meta property="og:title" content="Poisson Gravity">
<meta property="article:author" content="Ricky Reusser">
</head><body><div class="markdown-body"><!--{{{
  "name": "Poisson Gravity",
  "author": "Ricky Reusser"
}}}-->
<h1>Poisson Gravity</h1>
<p><a href="https://en.wikipedia.org/wiki/Newton&#x27;s_law_of_universal_gravitation">Newton's Law of Universal Gravitation</a> states that the force between two masses is proportional to the masses and inversely proportional to the square of the distance between the masses, that is, </p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><mi>G</mi><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mrow><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">F = G \frac{m_1 m_2}{r^2}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.10756em;"></span><span class="strut bottom" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mrel">=</span><span class="mord mathit">G</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">m</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">m</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathrm">.</span></span></span></span></span></p>
<p>It's a lovely law, but for computation it means every particle interacts with every other particle, an <!-- comment! --><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span><!-- comment! --> operations that quickly becomes prohibitive.</p>
<p>One way to avoid this issue is by grouping the particles hierarchically. That is, a from far away, a tightly packed cluster of particles looks just like a single particle. This is the basis of the <a href="https://en.wikipedia.org/wiki/Barnes%E2%80%93Hut_simulation">Barnes-Hut</a> method. Of course the particles aren't a single particle, so you get into <a href="https://en.wikipedia.org/wiki/Multipole_expansion">multipole expansion</a> that expands the clusters using spherical harmonics. It gets sorta complicated.</p>
<p>So today, I'll take a slightly different approach and model the mass as a continuum. ddsplat the particles onto a periodid grid in order to solve for the gravitational potential. Once we have the gravitational potential, computing the force on each particle is trivial.</p>
<p>Guass's law for gravity says that the divergence of the gravitational field is proportional to the mass density at each point, or </p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mi mathvariant="bold">g</mi></mrow><mo>=</mo><mo>−</mo><mn>4</mn><mi>π</mi><mi>G</mi><mi>ρ</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\nabla \cdot \mathbf{g} = -4 \pi G \rho.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">4</span><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="mord mathit">G</span><span class="mord mathit">ρ</span><span class="mord mathrm">.</span></span></span></span></span></p>
</div></body></html>